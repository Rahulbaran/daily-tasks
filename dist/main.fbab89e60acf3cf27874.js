/******/ (function() { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};

;// CONCATENATED MODULE: ./js/functions.js
var $listField = document.querySelector(".list__form input"); // Function for modifying String

var modifyString = function modifyString(str) {
  return str[0].toUpperCase() + str.slice(1).toLowerCase();
}; // Function for setting focus to list field


var listFieldFunc = function listFieldFunc() {
  $listField.value = "";
  $listField.focus();
};


;// CONCATENATED MODULE: ./js/main.js

 // Selectors

var main_$listField = document.querySelector(".list__form input");
var $listSubmitBtn = document.querySelector(".list__form button");
var $listContainer = document.querySelector(".list--container");
var $listTemplate = document.querySelector(".list__template");
var $itemTemplate = document.querySelector(".item__template");
var listId = 0,
    itemId = 0;
var appData = {
  list: [],
  listIds: [],
  listItemIds: new Map()
};
/*------------- Displaying list Data from localStorage on window loading -------------*/

window.addEventListener("load", function () {
  // Setting Focus to list Field
  listFieldFunc();
});
/*----------------- Event Handler for list input button -------------------*/

$listSubmitBtn.addEventListener("click", function (e) {
  // 1) Prevent Default Behavior
  e.preventDefault(); // 2) Get the list name

  var listName = main_$listField.value.trim(); // 3) Check for truthy value of listName

  if (listName && listName.length <= 20) {
    // i) Modify List Name
    listName = modifyString(listName); // iii) Store list index in appData.listIds array

    appData.listIds.push(listId); // ii) Store list in local Storage & also in appData.list array

    appData.list.push({
      listId: listId,
      listName: listName,
      items: []
    });
    localStorage.setItem("list", JSON.stringify(appData.list)); // iii) Empty input field

    listFieldFunc(); // iv) Display List in UI

    $listContainer.append($listTemplate.content.cloneNode(true));
    var $lastList = $listContainer.lastElementChild;
    $lastList.setAttribute("id", "list-".concat(listId));
    $lastList.querySelector("h2").innerText = listName; // v) Increase listId by 1

    listId++;
  }
});
/*----------- EventHandler for List Container When list is deleted -----------*/

$listContainer.addEventListener("click", function (e) {
  if (e.target.matches(".bx-trash")) {
    // i) Get the listId
    var _listId = +e.target.closest(".list").id.split("-")[1]; // ii) Find Index of the list


    var listIndex = appData.listIds.indexOf(_listId); // iii) Remove listId, listItems Ids & list from appData Object

    appData.listIds.splice(listIndex, 1);
    appData.listItemIds["delete"](_listId);
    appData.list.shift(appData.list[listIndex]); // iv) Update localStorage

    localStorage.setItem("list", JSON.stringify(appData)); // v) Update UI

    e.target.closest(".list").remove();
  }
});
/*----------- EventHandler for List Container When new item is added -----------*/

$listContainer.addEventListener("click", function (e) {
  var _e$target$previousEle, _e$target$previousEle2;

  var $itemInputField = e.target.previousElementSibling;
  var itemName = (_e$target$previousEle = e.target.previousElementSibling) === null || _e$target$previousEle === void 0 ? void 0 : (_e$target$previousEle2 = _e$target$previousEle.value) === null || _e$target$previousEle2 === void 0 ? void 0 : _e$target$previousEle2.trim(); // Check if item add button is clicked & itemName is truthy

  if (e.target.matches(".btn__item--add") && itemName && itemName.length <= 30) {
    // i) Modify itemName
    itemName = modifyString(itemName); // ii)  Get list id

    var itemsListId = +e.target.closest(".list").id.split("-")[1]; // iii) Store itemId in appData.listItemIds

    if (appData.listItemIds.has(itemsListId)) appData.listItemIds.get(itemsListId).push(itemId);else {
      appData.listItemIds.set(itemsListId, []);
      appData.listItemIds.get(itemsListId).push(itemId);
    } // iv) Store item in localStorage & appData.list array both

    var listIndex = appData.listIds.indexOf(itemsListId);
    appData.list[listIndex].items.push({
      itemId: itemId,
      itemName: itemName
    });
    localStorage.setItem("list", JSON.stringify(appData)); // v) Empty item Input Field & set the focus back

    $itemInputField.value = "";
    $itemInputField.focus(); // vi) Display item in UI

    var $itemsContainer = e.target.closest(".item__form").nextElementSibling;
    $itemsContainer.append($itemTemplate.content.cloneNode(true));
    var $lastItem = $itemsContainer.lastElementChild;
    $lastItem.setAttribute("id", "item-".concat(itemId));
    $lastItem.querySelector("p").innerText = itemName; // vii) Increase item id by 1

    itemId++;
  }
});
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBbEJBLENBb0JBOztJQUNBbUMsZUFBZSxDQUFDNUMsS0FBaEIsR0FBd0IsRUFBeEI7SUFDQTRDLGVBQWUsQ0FBQzNDLEtBQWhCLEdBdEJBLENBd0JBOztJQUNBLElBQU1rRCxlQUFlLEdBQUduQyxDQUFDLENBQUNrQixNQUFGLENBQVNFLE9BQVQsQ0FBaUIsYUFBakIsRUFBZ0NnQixrQkFBeEQ7SUFDQUQsZUFBZSxDQUFDeEIsTUFBaEIsQ0FBdUJyQixhQUFhLENBQUNzQixPQUFkLENBQXNCQyxTQUF0QixDQUFnQyxJQUFoQyxDQUF2QjtJQUNBLElBQU13QixTQUFTLEdBQUdGLGVBQWUsQ0FBQ3BCLGdCQUFsQztJQUNBc0IsU0FBUyxDQUFDckIsWUFBVixDQUF1QixJQUF2QixpQkFBcUN4QixNQUFyQztJQUNBNkMsU0FBUyxDQUFDNUQsYUFBVixDQUF3QixHQUF4QixFQUE2QndDLFNBQTdCLEdBQXlDYSxRQUF6QyxDQTdCQSxDQStCQTs7SUFDQXRDLE1BQU07RUFDUDtBQUNGLENBM0NELEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qcy9mdW5jdGlvbnMuanMiLCJ3ZWJwYWNrOi8vLy4vanMvbWFpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCAkbGlzdEZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5saXN0X19mb3JtIGlucHV0XCIpO1xuXG4vLyBGdW5jdGlvbiBmb3IgbW9kaWZ5aW5nIFN0cmluZ1xuY29uc3QgbW9kaWZ5U3RyaW5nID0gc3RyID0+IHN0clswXS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cbi8vIEZ1bmN0aW9uIGZvciBzZXR0aW5nIGZvY3VzIHRvIGxpc3QgZmllbGRcbmNvbnN0IGxpc3RGaWVsZEZ1bmMgPSAoKSA9PiB7XG4gICRsaXN0RmllbGQudmFsdWUgPSBcIlwiO1xuICAkbGlzdEZpZWxkLmZvY3VzKCk7XG59O1xuXG5leHBvcnQgeyBtb2RpZnlTdHJpbmcsIGxpc3RGaWVsZEZ1bmMgfTtcbiIsImltcG9ydCBcIi4uL3Njc3MvbWFpbi5zY3NzXCI7XG5pbXBvcnQgKiBhcyBmdW5jIGZyb20gXCIuL2Z1bmN0aW9uc1wiO1xuXG4vLyBTZWxlY3RvcnNcbmNvbnN0ICRsaXN0RmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxpc3RfX2Zvcm0gaW5wdXRcIik7XG5jb25zdCAkbGlzdFN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlzdF9fZm9ybSBidXR0b25cIik7XG5jb25zdCAkbGlzdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC0tY29udGFpbmVyXCIpO1xuY29uc3QgJGxpc3RUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlzdF9fdGVtcGxhdGVcIik7XG5jb25zdCAkaXRlbVRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pdGVtX190ZW1wbGF0ZVwiKTtcblxubGV0IFtsaXN0SWQsIGl0ZW1JZF0gPSBbMCwgMF07XG5jb25zdCBhcHBEYXRhID0ge1xuICBsaXN0OiBbXSxcbiAgbGlzdElkczogW10sXG4gIGxpc3RJdGVtSWRzOiBuZXcgTWFwKClcbn07XG5cbi8qLS0tLS0tLS0tLS0tLSBEaXNwbGF5aW5nIGxpc3QgRGF0YSBmcm9tIGxvY2FsU3RvcmFnZSBvbiB3aW5kb3cgbG9hZGluZyAtLS0tLS0tLS0tLS0tKi9cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XG4gIC8vIFNldHRpbmcgRm9jdXMgdG8gbGlzdCBGaWVsZFxuICBmdW5jLmxpc3RGaWVsZEZ1bmMoKTtcbn0pO1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tIEV2ZW50IEhhbmRsZXIgZm9yIGxpc3QgaW5wdXQgYnV0dG9uIC0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuJGxpc3RTdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4ge1xuICAvLyAxKSBQcmV2ZW50IERlZmF1bHQgQmVoYXZpb3JcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIC8vIDIpIEdldCB0aGUgbGlzdCBuYW1lXG4gIGxldCBsaXN0TmFtZSA9ICRsaXN0RmllbGQudmFsdWUudHJpbSgpO1xuXG4gIC8vIDMpIENoZWNrIGZvciB0cnV0aHkgdmFsdWUgb2YgbGlzdE5hbWVcbiAgaWYgKGxpc3ROYW1lICYmIGxpc3ROYW1lLmxlbmd0aCA8PSAyMCkge1xuICAgIC8vIGkpIE1vZGlmeSBMaXN0IE5hbWVcbiAgICBsaXN0TmFtZSA9IGZ1bmMubW9kaWZ5U3RyaW5nKGxpc3ROYW1lKTtcblxuICAgIC8vIGlpaSkgU3RvcmUgbGlzdCBpbmRleCBpbiBhcHBEYXRhLmxpc3RJZHMgYXJyYXlcbiAgICBhcHBEYXRhLmxpc3RJZHMucHVzaChsaXN0SWQpO1xuXG4gICAgLy8gaWkpIFN0b3JlIGxpc3QgaW4gbG9jYWwgU3RvcmFnZSAmIGFsc28gaW4gYXBwRGF0YS5saXN0IGFycmF5XG4gICAgYXBwRGF0YS5saXN0LnB1c2goeyBsaXN0SWQsIGxpc3ROYW1lLCBpdGVtczogW10gfSk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJsaXN0XCIsIEpTT04uc3RyaW5naWZ5KGFwcERhdGEubGlzdCkpO1xuXG4gICAgLy8gaWlpKSBFbXB0eSBpbnB1dCBmaWVsZFxuICAgIGZ1bmMubGlzdEZpZWxkRnVuYygpO1xuXG4gICAgLy8gaXYpIERpc3BsYXkgTGlzdCBpbiBVSVxuICAgICRsaXN0Q29udGFpbmVyLmFwcGVuZCgkbGlzdFRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpKTtcbiAgICBjb25zdCAkbGFzdExpc3QgPSAkbGlzdENvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkO1xuICAgICRsYXN0TGlzdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBgbGlzdC0ke2xpc3RJZH1gKTtcbiAgICAkbGFzdExpc3QucXVlcnlTZWxlY3RvcihcImgyXCIpLmlubmVyVGV4dCA9IGxpc3ROYW1lO1xuXG4gICAgLy8gdikgSW5jcmVhc2UgbGlzdElkIGJ5IDFcbiAgICBsaXN0SWQrKztcbiAgfVxufSk7XG5cbi8qLS0tLS0tLS0tLS0gRXZlbnRIYW5kbGVyIGZvciBMaXN0IENvbnRhaW5lciBXaGVuIGxpc3QgaXMgZGVsZXRlZCAtLS0tLS0tLS0tLSovXG4kbGlzdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XG4gIGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJ4LXRyYXNoXCIpKSB7XG4gICAgLy8gaSkgR2V0IHRoZSBsaXN0SWRcbiAgICBjb25zdCBsaXN0SWQgPSArZS50YXJnZXQuY2xvc2VzdChcIi5saXN0XCIpLmlkLnNwbGl0KFwiLVwiKVsxXTtcblxuICAgIC8vIGlpKSBGaW5kIEluZGV4IG9mIHRoZSBsaXN0XG4gICAgY29uc3QgbGlzdEluZGV4ID0gYXBwRGF0YS5saXN0SWRzLmluZGV4T2YobGlzdElkKTtcblxuICAgIC8vIGlpaSkgUmVtb3ZlIGxpc3RJZCwgbGlzdEl0ZW1zIElkcyAmIGxpc3QgZnJvbSBhcHBEYXRhIE9iamVjdFxuICAgIGFwcERhdGEubGlzdElkcy5zcGxpY2UobGlzdEluZGV4LCAxKTtcbiAgICBhcHBEYXRhLmxpc3RJdGVtSWRzLmRlbGV0ZShsaXN0SWQpO1xuICAgIGFwcERhdGEubGlzdC5zaGlmdChhcHBEYXRhLmxpc3RbbGlzdEluZGV4XSk7XG5cbiAgICAvLyBpdikgVXBkYXRlIGxvY2FsU3RvcmFnZVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwibGlzdFwiLCBKU09OLnN0cmluZ2lmeShhcHBEYXRhKSk7XG5cbiAgICAvLyB2KSBVcGRhdGUgVUlcbiAgICBlLnRhcmdldC5jbG9zZXN0KFwiLmxpc3RcIikucmVtb3ZlKCk7XG4gIH1cbn0pO1xuXG4vKi0tLS0tLS0tLS0tIEV2ZW50SGFuZGxlciBmb3IgTGlzdCBDb250YWluZXIgV2hlbiBuZXcgaXRlbSBpcyBhZGRlZCAtLS0tLS0tLS0tLSovXG4kbGlzdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgY29uc3QgJGl0ZW1JbnB1dEZpZWxkID0gZS50YXJnZXQucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgbGV0IGl0ZW1OYW1lID0gZS50YXJnZXQucHJldmlvdXNFbGVtZW50U2libGluZz8udmFsdWU/LnRyaW0oKTtcblxuICAvLyBDaGVjayBpZiBpdGVtIGFkZCBidXR0b24gaXMgY2xpY2tlZCAmIGl0ZW1OYW1lIGlzIHRydXRoeVxuICBpZiAoXG4gICAgZS50YXJnZXQubWF0Y2hlcyhcIi5idG5fX2l0ZW0tLWFkZFwiKSAmJlxuICAgIGl0ZW1OYW1lICYmXG4gICAgaXRlbU5hbWUubGVuZ3RoIDw9IDMwXG4gICkge1xuICAgIC8vIGkpIE1vZGlmeSBpdGVtTmFtZVxuICAgIGl0ZW1OYW1lID0gZnVuYy5tb2RpZnlTdHJpbmcoaXRlbU5hbWUpO1xuXG4gICAgLy8gaWkpICBHZXQgbGlzdCBpZFxuICAgIGNvbnN0IGl0ZW1zTGlzdElkID0gK2UudGFyZ2V0LmNsb3Nlc3QoXCIubGlzdFwiKS5pZC5zcGxpdChcIi1cIilbMV07XG5cbiAgICAvLyBpaWkpIFN0b3JlIGl0ZW1JZCBpbiBhcHBEYXRhLmxpc3RJdGVtSWRzXG4gICAgaWYgKGFwcERhdGEubGlzdEl0ZW1JZHMuaGFzKGl0ZW1zTGlzdElkKSlcbiAgICAgIGFwcERhdGEubGlzdEl0ZW1JZHMuZ2V0KGl0ZW1zTGlzdElkKS5wdXNoKGl0ZW1JZCk7XG4gICAgZWxzZSB7XG4gICAgICBhcHBEYXRhLmxpc3RJdGVtSWRzLnNldChpdGVtc0xpc3RJZCwgW10pO1xuICAgICAgYXBwRGF0YS5saXN0SXRlbUlkcy5nZXQoaXRlbXNMaXN0SWQpLnB1c2goaXRlbUlkKTtcbiAgICB9XG5cbiAgICAvLyBpdikgU3RvcmUgaXRlbSBpbiBsb2NhbFN0b3JhZ2UgJiBhcHBEYXRhLmxpc3QgYXJyYXkgYm90aFxuICAgIGNvbnN0IGxpc3RJbmRleCA9IGFwcERhdGEubGlzdElkcy5pbmRleE9mKGl0ZW1zTGlzdElkKTtcbiAgICBhcHBEYXRhLmxpc3RbbGlzdEluZGV4XS5pdGVtcy5wdXNoKHsgaXRlbUlkLCBpdGVtTmFtZSB9KTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImxpc3RcIiwgSlNPTi5zdHJpbmdpZnkoYXBwRGF0YSkpO1xuXG4gICAgLy8gdikgRW1wdHkgaXRlbSBJbnB1dCBGaWVsZCAmIHNldCB0aGUgZm9jdXMgYmFja1xuICAgICRpdGVtSW5wdXRGaWVsZC52YWx1ZSA9IFwiXCI7XG4gICAgJGl0ZW1JbnB1dEZpZWxkLmZvY3VzKCk7XG5cbiAgICAvLyB2aSkgRGlzcGxheSBpdGVtIGluIFVJXG4gICAgY29uc3QgJGl0ZW1zQ29udGFpbmVyID0gZS50YXJnZXQuY2xvc2VzdChcIi5pdGVtX19mb3JtXCIpLm5leHRFbGVtZW50U2libGluZztcbiAgICAkaXRlbXNDb250YWluZXIuYXBwZW5kKCRpdGVtVGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgIGNvbnN0ICRsYXN0SXRlbSA9ICRpdGVtc0NvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkO1xuICAgICRsYXN0SXRlbS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBgaXRlbS0ke2l0ZW1JZH1gKTtcbiAgICAkbGFzdEl0ZW0ucXVlcnlTZWxlY3RvcihcInBcIikuaW5uZXJUZXh0ID0gaXRlbU5hbWU7XG5cbiAgICAvLyB2aWkpIEluY3JlYXNlIGl0ZW0gaWQgYnkgMVxuICAgIGl0ZW1JZCsrO1xuICB9XG59KTtcbiJdLCJuYW1lcyI6WyIkbGlzdEZpZWxkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibW9kaWZ5U3RyaW5nIiwic3RyIiwidG9VcHBlckNhc2UiLCJzbGljZSIsInRvTG93ZXJDYXNlIiwibGlzdEZpZWxkRnVuYyIsInZhbHVlIiwiZm9jdXMiLCJmdW5jIiwiJGxpc3RTdWJtaXRCdG4iLCIkbGlzdENvbnRhaW5lciIsIiRsaXN0VGVtcGxhdGUiLCIkaXRlbVRlbXBsYXRlIiwibGlzdElkIiwiaXRlbUlkIiwiYXBwRGF0YSIsImxpc3QiLCJsaXN0SWRzIiwibGlzdEl0ZW1JZHMiLCJNYXAiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwibGlzdE5hbWUiLCJ0cmltIiwibGVuZ3RoIiwicHVzaCIsIml0ZW1zIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhcHBlbmQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiJGxhc3RMaXN0IiwibGFzdEVsZW1lbnRDaGlsZCIsInNldEF0dHJpYnV0ZSIsImlubmVyVGV4dCIsInRhcmdldCIsIm1hdGNoZXMiLCJjbG9zZXN0IiwiaWQiLCJzcGxpdCIsImxpc3RJbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJzaGlmdCIsInJlbW92ZSIsIiRpdGVtSW5wdXRGaWVsZCIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJpdGVtTmFtZSIsIml0ZW1zTGlzdElkIiwiaGFzIiwiZ2V0Iiwic2V0IiwiJGl0ZW1zQ29udGFpbmVyIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiJGxhc3RJdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==