/******/ (function() { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};

;// CONCATENATED MODULE: ./js/functions.js
var $listField = document.querySelector(".list__form input"); // Function for modifying String

var modifyString = function modifyString(str) {
  return str[0].toUpperCase() + str.slice(1).toLowerCase();
}; // Function for setting focus to list field


var listFieldFunc = function listFieldFunc() {
  $listField.value = "";
  $listField.focus();
}; // Function for storing JSON Data in localStorage


var storeJson = function storeJson(key, value) {
  return localStorage.setItem(key, JSON.stringify(value));
}; // Function for parsing JSON Data retrieved from localStorage


var parseJson = function parseJson(data) {
  return JSON.parse(localStorage.getItem(data));
};


;// CONCATENATED MODULE: ./js/main.js

 // Selectors

var main_$listField = document.querySelector(".list__form input");
var $listSubmitBtn = document.querySelector(".list__form button");
var $listContainer = document.querySelector(".list--container");
var $listTemplate = document.querySelector(".list__template");
var $itemTemplate = document.querySelector(".item__template");
var listId = 0,
    itemId = 0;
var appData = {
  list: [],
  listIds: [],
  lastItemId: 0
};
var listItemIds = new Map(); // Function for displaying list

var displayList = function displayList(list) {
  $listContainer.append($listTemplate.content.cloneNode(true));
  var $lastList = $listContainer.lastElementChild;
  $lastList.setAttribute("id", "list-".concat(list.listId));
  $lastList.querySelector("h2").innerText = list.listName;
}; // Function for displaying list's item


var displayListItem = function displayListItem(itemsContainer, item) {
  itemsContainer.append($itemTemplate.content.cloneNode(true));
  var $lastItem = itemsContainer.lastElementChild;
  $lastItem.setAttribute("id", "item-".concat(item.itemId));
  $lastItem.querySelector("p").innerText = item.itemName;
};
/*------------- Displaying list Data from localStorage on window loading -------------*/


window.addEventListener("load", function () {
  // i) Setting Focus to list Field
  listFieldFunc(); // ii) Reassigning data to variables

  var _ref = [parseJson("list"), parseJson("listItemIds")],
      listData = _ref[0],
      itemIds = _ref[1];

  if (listData && listData.listIds.length) {
    appData = listData;
    listId = listData.listIds.at(-1) + 1;
  }

  if (listData && listData.lastItemId) {
    listItemIds = new Map(Object.entries(itemIds));
    itemId = listData.lastItemId + 1;
  } // iii) Display lists & their items in UI


  if (listData && listData.list.length) {
    listData.list.forEach(function (list) {
      displayList(list);
      var $itemsWrapper = $listContainer.lastElementChild.querySelector(".items__wrapper");
      list.items.forEach(function (item) {
        displayListItem($itemsWrapper, item);
      });
    });
  }
});
/*----------------- Event Handler for list input button -------------------*/

$listSubmitBtn.addEventListener("click", function (e) {
  // 1) Prevent Default Behavior
  e.preventDefault(); // 2) Get the list name

  var listName = main_$listField.value.trim(); // 3) Check for truthy value of listName

  if (listName && listName.length <= 20) {
    // i) Modify List Name
    listName = modifyString(listName); // iii) Store list index in appData.listIds array

    appData.listIds.push(listId); // ii) Store list in local Storage & also in appData.list array

    appData.list.push({
      listId: listId,
      listName: listName,
      items: []
    });
    storeJson("list", appData); // iii) Empty input field

    listFieldFunc(); // iv) Display List in UI

    displayList({
      listId: listId,
      listName: listName
    }); // v) Increase listId by 1

    listId++;
  }
});
/*----------- EventHandler for List Container When list is deleted -----------*/

$listContainer.addEventListener("click", function (e) {
  if (e.target.matches(".bx-trash")) {
    // i) Get the listId
    var _listId = +e.target.closest(".list").id.split("-")[1]; // ii) Find Index of the list


    var listIndex = appData.listIds.indexOf(_listId); // iii) Remove listId, listItems Ids & list from appData Object

    appData.listIds.splice(listIndex, 1);
    listItemIds["delete"](String(_listId));
    appData.list.splice(listIndex, 1); // iv) Update localStorage

    storeJson("list", appData);
    storeJson("listItemIds", Object.fromEntries(listItemIds)); // v) Update UI

    e.target.closest(".list").remove();
  }
});
/*----------- EventHandler for List Container When new item is added -----------*/

$listContainer.addEventListener("click", function (e) {
  var _e$target$previousEle, _e$target$previousEle2;

  var $itemInputField = e.target.previousElementSibling;
  var itemName = (_e$target$previousEle = e.target.previousElementSibling) === null || _e$target$previousEle === void 0 ? void 0 : (_e$target$previousEle2 = _e$target$previousEle.value) === null || _e$target$previousEle2 === void 0 ? void 0 : _e$target$previousEle2.trim(); // Check if item add button is clicked & itemName is truthy

  if (e.target.matches(".btn__item--add") && itemName && itemName.length <= 30) {
    // i) Modify itemName
    itemName = modifyString(itemName); // ii)  Get list id

    var itemsListId = e.target.closest(".list").id.split("-")[1]; // iii) Store itemId in listItemIds map & in localStorage

    listItemIds.has(itemsListId) ? listItemIds.get(itemsListId).push(itemId) : listItemIds.set(itemsListId, []).get(itemsListId).push(itemId);
    storeJson("listItemIds", Object.fromEntries(listItemIds)); // iv) Store item in localStorage & appData.list array both

    var listIndex = appData.listIds.indexOf(+itemsListId);
    appData.list[listIndex].items.push({
      itemId: itemId,
      itemName: itemName
    });
    appData.lastItemId = itemId;
    storeJson("list", appData); // v) Empty item Input Field & set the focus

    $itemInputField.value = "";
    $itemInputField.focus(); // vi) Display item in UI

    var $itemsContainer = e.target.closest(".item__form").nextElementSibling;
    displayListItem($itemsContainer, {
      itemId: itemId,
      itemName: itemName
    }); // vii) Increase item id by 1

    itemId++;
  }
});
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNLEVBQU5BLE1BQUY7TUFBVW9CLFFBQVEsRUFBUkE7SUFBVixDQUFsQixDQUFmLENBMUJBLENBNEJBOztJQUNBcEIsTUFBTTtFQUNQO0FBQ0YsQ0F4Q0QsRSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2pzL2Z1bmN0aW9ucy5qcyIsIndlYnBhY2s6Ly8vLi9qcy9tYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0ICRsaXN0RmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxpc3RfX2Zvcm0gaW5wdXRcIik7XG5cbi8vIEZ1bmN0aW9uIGZvciBtb2RpZnlpbmcgU3RyaW5nXG5jb25zdCBtb2RpZnlTdHJpbmcgPSBzdHIgPT4gc3RyWzBdLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcblxuLy8gRnVuY3Rpb24gZm9yIHNldHRpbmcgZm9jdXMgdG8gbGlzdCBmaWVsZFxuY29uc3QgbGlzdEZpZWxkRnVuYyA9ICgpID0+IHtcbiAgJGxpc3RGaWVsZC52YWx1ZSA9IFwiXCI7XG4gICRsaXN0RmllbGQuZm9jdXMoKTtcbn07XG5cbi8vIEZ1bmN0aW9uIGZvciBzdG9yaW5nIEpTT04gRGF0YSBpbiBsb2NhbFN0b3JhZ2VcbmNvbnN0IHN0b3JlSnNvbiA9IChrZXksIHZhbHVlKSA9PlxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG5cbi8vIEZ1bmN0aW9uIGZvciBwYXJzaW5nIEpTT04gRGF0YSByZXRyaWV2ZWQgZnJvbSBsb2NhbFN0b3JhZ2VcbmNvbnN0IHBhcnNlSnNvbiA9IGRhdGEgPT4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShkYXRhKSk7XG5cbmV4cG9ydCB7IG1vZGlmeVN0cmluZywgbGlzdEZpZWxkRnVuYywgc3RvcmVKc29uLCBwYXJzZUpzb24gfTtcbiIsImltcG9ydCBcIi4uL3Njc3MvbWFpbi5zY3NzXCI7XG5pbXBvcnQgKiBhcyBmdW5jIGZyb20gXCIuL2Z1bmN0aW9uc1wiO1xuXG4vLyBTZWxlY3RvcnNcbmNvbnN0ICRsaXN0RmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxpc3RfX2Zvcm0gaW5wdXRcIik7XG5jb25zdCAkbGlzdFN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlzdF9fZm9ybSBidXR0b25cIik7XG5jb25zdCAkbGlzdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC0tY29udGFpbmVyXCIpO1xuY29uc3QgJGxpc3RUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlzdF9fdGVtcGxhdGVcIik7XG5jb25zdCAkaXRlbVRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pdGVtX190ZW1wbGF0ZVwiKTtcblxubGV0IFtsaXN0SWQsIGl0ZW1JZF0gPSBbMCwgMF07XG5sZXQgYXBwRGF0YSA9IHtcbiAgbGlzdDogW10sXG4gIGxpc3RJZHM6IFtdLFxuICBsYXN0SXRlbUlkOiAwXG59O1xubGV0IGxpc3RJdGVtSWRzID0gbmV3IE1hcCgpO1xuXG4vLyBGdW5jdGlvbiBmb3IgZGlzcGxheWluZyBsaXN0XG5jb25zdCBkaXNwbGF5TGlzdCA9IGxpc3QgPT4ge1xuICAkbGlzdENvbnRhaW5lci5hcHBlbmQoJGxpc3RUZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKSk7XG4gIGNvbnN0ICRsYXN0TGlzdCA9ICRsaXN0Q29udGFpbmVyLmxhc3RFbGVtZW50Q2hpbGQ7XG4gICRsYXN0TGlzdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBgbGlzdC0ke2xpc3QubGlzdElkfWApO1xuICAkbGFzdExpc3QucXVlcnlTZWxlY3RvcihcImgyXCIpLmlubmVyVGV4dCA9IGxpc3QubGlzdE5hbWU7XG59O1xuXG4vLyBGdW5jdGlvbiBmb3IgZGlzcGxheWluZyBsaXN0J3MgaXRlbVxuY29uc3QgZGlzcGxheUxpc3RJdGVtID0gKGl0ZW1zQ29udGFpbmVyLCBpdGVtKSA9PiB7XG4gIGl0ZW1zQ29udGFpbmVyLmFwcGVuZCgkaXRlbVRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpKTtcbiAgY29uc3QgJGxhc3RJdGVtID0gaXRlbXNDb250YWluZXIubGFzdEVsZW1lbnRDaGlsZDtcbiAgJGxhc3RJdGVtLnNldEF0dHJpYnV0ZShcImlkXCIsIGBpdGVtLSR7aXRlbS5pdGVtSWR9YCk7XG4gICRsYXN0SXRlbS5xdWVyeVNlbGVjdG9yKFwicFwiKS5pbm5lclRleHQgPSBpdGVtLml0ZW1OYW1lO1xufTtcblxuLyotLS0tLS0tLS0tLS0tIERpc3BsYXlpbmcgbGlzdCBEYXRhIGZyb20gbG9jYWxTdG9yYWdlIG9uIHdpbmRvdyBsb2FkaW5nIC0tLS0tLS0tLS0tLS0qL1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHtcbiAgLy8gaSkgU2V0dGluZyBGb2N1cyB0byBsaXN0IEZpZWxkXG4gIGZ1bmMubGlzdEZpZWxkRnVuYygpO1xuXG4gIC8vIGlpKSBSZWFzc2lnbmluZyBkYXRhIHRvIHZhcmlhYmxlc1xuICBjb25zdCBbbGlzdERhdGEsIGl0ZW1JZHNdID0gW1xuICAgIGZ1bmMucGFyc2VKc29uKFwibGlzdFwiKSxcbiAgICBmdW5jLnBhcnNlSnNvbihcImxpc3RJdGVtSWRzXCIpXG4gIF07XG4gIGlmIChsaXN0RGF0YSAmJiBsaXN0RGF0YS5saXN0SWRzLmxlbmd0aCkge1xuICAgIGFwcERhdGEgPSBsaXN0RGF0YTtcbiAgICBsaXN0SWQgPSBsaXN0RGF0YS5saXN0SWRzLmF0KC0xKSArIDE7XG4gIH1cbiAgaWYgKGxpc3REYXRhICYmIGxpc3REYXRhLmxhc3RJdGVtSWQpIHtcbiAgICBsaXN0SXRlbUlkcyA9IG5ldyBNYXAoT2JqZWN0LmVudHJpZXMoaXRlbUlkcykpO1xuICAgIGl0ZW1JZCA9IGxpc3REYXRhLmxhc3RJdGVtSWQgKyAxO1xuICB9XG5cbiAgLy8gaWlpKSBEaXNwbGF5IGxpc3RzICYgdGhlaXIgaXRlbXMgaW4gVUlcbiAgaWYgKGxpc3REYXRhICYmIGxpc3REYXRhLmxpc3QubGVuZ3RoKSB7XG4gICAgbGlzdERhdGEubGlzdC5mb3JFYWNoKGxpc3QgPT4ge1xuICAgICAgZGlzcGxheUxpc3QobGlzdCk7XG4gICAgICBjb25zdCAkaXRlbXNXcmFwcGVyID1cbiAgICAgICAgJGxpc3RDb250YWluZXIubGFzdEVsZW1lbnRDaGlsZC5xdWVyeVNlbGVjdG9yKFwiLml0ZW1zX193cmFwcGVyXCIpO1xuICAgICAgbGlzdC5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBkaXNwbGF5TGlzdEl0ZW0oJGl0ZW1zV3JhcHBlciwgaXRlbSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0gRXZlbnQgSGFuZGxlciBmb3IgbGlzdCBpbnB1dCBidXR0b24gLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4kbGlzdFN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XG4gIC8vIDEpIFByZXZlbnQgRGVmYXVsdCBCZWhhdmlvclxuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgLy8gMikgR2V0IHRoZSBsaXN0IG5hbWVcbiAgbGV0IGxpc3ROYW1lID0gJGxpc3RGaWVsZC52YWx1ZS50cmltKCk7XG5cbiAgLy8gMykgQ2hlY2sgZm9yIHRydXRoeSB2YWx1ZSBvZiBsaXN0TmFtZVxuICBpZiAobGlzdE5hbWUgJiYgbGlzdE5hbWUubGVuZ3RoIDw9IDIwKSB7XG4gICAgLy8gaSkgTW9kaWZ5IExpc3QgTmFtZVxuICAgIGxpc3ROYW1lID0gZnVuYy5tb2RpZnlTdHJpbmcobGlzdE5hbWUpO1xuXG4gICAgLy8gaWlpKSBTdG9yZSBsaXN0IGluZGV4IGluIGFwcERhdGEubGlzdElkcyBhcnJheVxuICAgIGFwcERhdGEubGlzdElkcy5wdXNoKGxpc3RJZCk7XG5cbiAgICAvLyBpaSkgU3RvcmUgbGlzdCBpbiBsb2NhbCBTdG9yYWdlICYgYWxzbyBpbiBhcHBEYXRhLmxpc3QgYXJyYXlcbiAgICBhcHBEYXRhLmxpc3QucHVzaCh7IGxpc3RJZCwgbGlzdE5hbWUsIGl0ZW1zOiBbXSB9KTtcbiAgICBmdW5jLnN0b3JlSnNvbihcImxpc3RcIiwgYXBwRGF0YSk7XG5cbiAgICAvLyBpaWkpIEVtcHR5IGlucHV0IGZpZWxkXG4gICAgZnVuYy5saXN0RmllbGRGdW5jKCk7XG5cbiAgICAvLyBpdikgRGlzcGxheSBMaXN0IGluIFVJXG4gICAgZGlzcGxheUxpc3QoeyBsaXN0SWQsIGxpc3ROYW1lIH0pO1xuXG4gICAgLy8gdikgSW5jcmVhc2UgbGlzdElkIGJ5IDFcbiAgICBsaXN0SWQrKztcbiAgfVxufSk7XG5cbi8qLS0tLS0tLS0tLS0gRXZlbnRIYW5kbGVyIGZvciBMaXN0IENvbnRhaW5lciBXaGVuIGxpc3QgaXMgZGVsZXRlZCAtLS0tLS0tLS0tLSovXG4kbGlzdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XG4gIGlmIChlLnRhcmdldC5tYXRjaGVzKFwiLmJ4LXRyYXNoXCIpKSB7XG4gICAgLy8gaSkgR2V0IHRoZSBsaXN0SWRcbiAgICBjb25zdCBsaXN0SWQgPSArZS50YXJnZXQuY2xvc2VzdChcIi5saXN0XCIpLmlkLnNwbGl0KFwiLVwiKVsxXTtcblxuICAgIC8vIGlpKSBGaW5kIEluZGV4IG9mIHRoZSBsaXN0XG4gICAgY29uc3QgbGlzdEluZGV4ID0gYXBwRGF0YS5saXN0SWRzLmluZGV4T2YobGlzdElkKTtcblxuICAgIC8vIGlpaSkgUmVtb3ZlIGxpc3RJZCwgbGlzdEl0ZW1zIElkcyAmIGxpc3QgZnJvbSBhcHBEYXRhIE9iamVjdFxuICAgIGFwcERhdGEubGlzdElkcy5zcGxpY2UobGlzdEluZGV4LCAxKTtcbiAgICBsaXN0SXRlbUlkcy5kZWxldGUoU3RyaW5nKGxpc3RJZCkpO1xuICAgIGFwcERhdGEubGlzdC5zcGxpY2UobGlzdEluZGV4LCAxKTtcblxuICAgIC8vIGl2KSBVcGRhdGUgbG9jYWxTdG9yYWdlXG4gICAgZnVuYy5zdG9yZUpzb24oXCJsaXN0XCIsIGFwcERhdGEpO1xuICAgIGZ1bmMuc3RvcmVKc29uKFwibGlzdEl0ZW1JZHNcIiwgT2JqZWN0LmZyb21FbnRyaWVzKGxpc3RJdGVtSWRzKSk7XG5cbiAgICAvLyB2KSBVcGRhdGUgVUlcbiAgICBlLnRhcmdldC5jbG9zZXN0KFwiLmxpc3RcIikucmVtb3ZlKCk7XG4gIH1cbn0pO1xuXG4vKi0tLS0tLS0tLS0tIEV2ZW50SGFuZGxlciBmb3IgTGlzdCBDb250YWluZXIgV2hlbiBuZXcgaXRlbSBpcyBhZGRlZCAtLS0tLS0tLS0tLSovXG4kbGlzdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgY29uc3QgJGl0ZW1JbnB1dEZpZWxkID0gZS50YXJnZXQucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgbGV0IGl0ZW1OYW1lID0gZS50YXJnZXQucHJldmlvdXNFbGVtZW50U2libGluZz8udmFsdWU/LnRyaW0oKTtcblxuICAvLyBDaGVjayBpZiBpdGVtIGFkZCBidXR0b24gaXMgY2xpY2tlZCAmIGl0ZW1OYW1lIGlzIHRydXRoeVxuICBpZiAoXG4gICAgZS50YXJnZXQubWF0Y2hlcyhcIi5idG5fX2l0ZW0tLWFkZFwiKSAmJlxuICAgIGl0ZW1OYW1lICYmXG4gICAgaXRlbU5hbWUubGVuZ3RoIDw9IDMwXG4gICkge1xuICAgIC8vIGkpIE1vZGlmeSBpdGVtTmFtZVxuICAgIGl0ZW1OYW1lID0gZnVuYy5tb2RpZnlTdHJpbmcoaXRlbU5hbWUpO1xuXG4gICAgLy8gaWkpICBHZXQgbGlzdCBpZFxuICAgIGNvbnN0IGl0ZW1zTGlzdElkID0gZS50YXJnZXQuY2xvc2VzdChcIi5saXN0XCIpLmlkLnNwbGl0KFwiLVwiKVsxXTtcblxuICAgIC8vIGlpaSkgU3RvcmUgaXRlbUlkIGluIGxpc3RJdGVtSWRzIG1hcCAmIGluIGxvY2FsU3RvcmFnZVxuICAgIGxpc3RJdGVtSWRzLmhhcyhpdGVtc0xpc3RJZClcbiAgICAgID8gbGlzdEl0ZW1JZHMuZ2V0KGl0ZW1zTGlzdElkKS5wdXNoKGl0ZW1JZClcbiAgICAgIDogbGlzdEl0ZW1JZHMuc2V0KGl0ZW1zTGlzdElkLCBbXSkuZ2V0KGl0ZW1zTGlzdElkKS5wdXNoKGl0ZW1JZCk7XG5cbiAgICBmdW5jLnN0b3JlSnNvbihcImxpc3RJdGVtSWRzXCIsIE9iamVjdC5mcm9tRW50cmllcyhsaXN0SXRlbUlkcykpO1xuXG4gICAgLy8gaXYpIFN0b3JlIGl0ZW0gaW4gbG9jYWxTdG9yYWdlICYgYXBwRGF0YS5saXN0IGFycmF5IGJvdGhcbiAgICBjb25zdCBsaXN0SW5kZXggPSBhcHBEYXRhLmxpc3RJZHMuaW5kZXhPZigraXRlbXNMaXN0SWQpO1xuICAgIGFwcERhdGEubGlzdFtsaXN0SW5kZXhdLml0ZW1zLnB1c2goeyBpdGVtSWQsIGl0ZW1OYW1lIH0pO1xuICAgIGFwcERhdGEubGFzdEl0ZW1JZCA9IGl0ZW1JZDtcbiAgICBmdW5jLnN0b3JlSnNvbihcImxpc3RcIiwgYXBwRGF0YSk7XG5cbiAgICAvLyB2KSBFbXB0eSBpdGVtIElucHV0IEZpZWxkICYgc2V0IHRoZSBmb2N1c1xuICAgICRpdGVtSW5wdXRGaWVsZC52YWx1ZSA9IFwiXCI7XG4gICAgJGl0ZW1JbnB1dEZpZWxkLmZvY3VzKCk7XG5cbiAgICAvLyB2aSkgRGlzcGxheSBpdGVtIGluIFVJXG4gICAgY29uc3QgJGl0ZW1zQ29udGFpbmVyID0gZS50YXJnZXQuY2xvc2VzdChcIi5pdGVtX19mb3JtXCIpLm5leHRFbGVtZW50U2libGluZztcbiAgICBkaXNwbGF5TGlzdEl0ZW0oJGl0ZW1zQ29udGFpbmVyLCB7IGl0ZW1JZCwgaXRlbU5hbWUgfSk7XG5cbiAgICAvLyB2aWkpIEluY3JlYXNlIGl0ZW0gaWQgYnkgMVxuICAgIGl0ZW1JZCsrO1xuICB9XG59KTtcbiJdLCJuYW1lcyI6WyIkbGlzdEZpZWxkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibW9kaWZ5U3RyaW5nIiwic3RyIiwidG9VcHBlckNhc2UiLCJzbGljZSIsInRvTG93ZXJDYXNlIiwibGlzdEZpZWxkRnVuYyIsInZhbHVlIiwiZm9jdXMiLCJzdG9yZUpzb24iLCJrZXkiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsInBhcnNlSnNvbiIsImRhdGEiLCJwYXJzZSIsImdldEl0ZW0iLCJmdW5jIiwiJGxpc3RTdWJtaXRCdG4iLCIkbGlzdENvbnRhaW5lciIsIiRsaXN0VGVtcGxhdGUiLCIkaXRlbVRlbXBsYXRlIiwibGlzdElkIiwiaXRlbUlkIiwiYXBwRGF0YSIsImxpc3QiLCJsaXN0SWRzIiwibGFzdEl0ZW1JZCIsImxpc3RJdGVtSWRzIiwiTWFwIiwiZGlzcGxheUxpc3QiLCJhcHBlbmQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiJGxhc3RMaXN0IiwibGFzdEVsZW1lbnRDaGlsZCIsInNldEF0dHJpYnV0ZSIsImlubmVyVGV4dCIsImxpc3ROYW1lIiwiZGlzcGxheUxpc3RJdGVtIiwiaXRlbXNDb250YWluZXIiLCJpdGVtIiwiJGxhc3RJdGVtIiwiaXRlbU5hbWUiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibGlzdERhdGEiLCJpdGVtSWRzIiwibGVuZ3RoIiwiYXQiLCJPYmplY3QiLCJlbnRyaWVzIiwiZm9yRWFjaCIsIiRpdGVtc1dyYXBwZXIiLCJpdGVtcyIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRyaW0iLCJwdXNoIiwidGFyZ2V0IiwibWF0Y2hlcyIsImNsb3Nlc3QiLCJpZCIsInNwbGl0IiwibGlzdEluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsIlN0cmluZyIsImZyb21FbnRyaWVzIiwicmVtb3ZlIiwiJGl0ZW1JbnB1dEZpZWxkIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsIml0ZW1zTGlzdElkIiwiaGFzIiwiZ2V0Iiwic2V0IiwiJGl0ZW1zQ29udGFpbmVyIiwibmV4dEVsZW1lbnRTaWJsaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==